{% extends 'base.html' %}

{%block content%}

<div class="pure-g">
   <div class="pure-u-1-5"></div>
   <div class="pure-u-3-5">
      <h1>Timeline</h1>
   </div>

</div>
<div class="pure-g">
   <div class="pure-u-1-5"></div>
   <div class="pure-u-3-5 timeline">

   </div>
</div>
<div class="pure-g">
   <div class="pure-u-1-5"></div>
   <div class="pure-u-3-5 chart-wrapper">
      <div class="chart-wrapper-scroll" id="tester">
      </div>
   </div>
</div>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>
var data = [];

dataX = [
   {% for i in feeling_data %}
      "{{i.date}}" ,
   {% endfor %}
   {% for i in feeling_axis %}
      "0",
   {% endfor %}
]

dataY = [

   {% for i in feeling_data %}
      "{{i.feeling}}" ,
   {% endfor %}
   {% for i in feeling_axis %}
      "{{i}}",
   {% endfor %}
]


//-- Oh django! you my life so complicated!
let feelingList = [
   {% for i in feeling_axis %}
      "{{i}}",
   {% endfor %}
];

var date = new Date(); // some mock date
var date_ms = parseInt(date.getTime());
// console.log(date_ms,data)

var layout = {
   yaxis: {fixedrange: true, range: [0,feelingList.length-1]},
   xaxis: {fixedrange: false, scroll: true, scollZoom:false, type: 'date', range: [date_ms-86400000*7,date_ms+86400000]},
	dragmode: "pan",
   margin: {t: 0},
   type: "scatter",
   mode: "markers",
   paper_bgcolor: "rgb(200,200,210)",
   plot_bgcolor: "rgb(200,200,210)",
   margin: {l:70, r:40, t:40},

}

var trace1 = {
   x: dataX,
   y: dataY,
   type: 'scatter',
   width: 20000000,
   marker: {"color": "#5080a0", "size": 22},
   mode: "markers"
}

TESTER = document.getElementById("tester");
	Plotly.newPlot( TESTER, [trace1],
   layout,
   {displayModeBar: false},
);
</script>
{%endblock%}
